# JWT 등장 배경

JWT는 Json Web Token으로, 웹 애플리케이션에서 인증 및 정보 교환을 위해 사용하는 토근 기반의 인증 방식을 일컫는다.
이 인증 방식은 기존의 웹 애플리케이션이 가지고 있던 인증 및 보안 문제를 해결하기 위해 출현하게 되었다.

현재까지도 많은 레거시 환경에서 사용하고 있는 세션 인증 방식은 사용자가 웹 애플리케이션에 로그인을 수행하면,
서버에서는 해당 인증에 대한 세션을 유지하고, 서버에게로 매 요청을 보낼 때마다, 세션 ID를 쿠키 등으로 전송하여 인증을 유지하는 방식이다.

이 세션 기반 인증 방식은 서버에 세션의 상태를 계속 유지해야 하며, 확장성과 서버 부하에도 적잖은 문제가 된다.
물론, 그렇다고 해서 확장이 불가능한 것은 아니고, 세션 클러스터링을 통해 세션 기반 인증 방식도 멀티 서버 환경에서 동작이 가능하다.

여하튼, JWT는 이러한 단점들을 극복하기 위해 나왔는데, 이 JWT는 Claim이라는 JSON 객체를 사용하여 사용자 정보 및 추가적인 정보를
안전하게 저장하며, 세션 방식과 다르게 서버 측에 세션 상태를 유지하지 않고 토큰 자체가 사용자를 인증할 수 있는 매개체 역할을 수행한다.

# JWT의 장점
- **Stateless** : 앞서 언급한 바와 같이 세션 상태를 유지할 필요 없이 토큰 자체가 사용자를 인증하므로 사용자 정보를 저장할 필요가 없다.
- **Scalable** : 세션을 사용하지 않기 때문에 여러 노드에서 동일한 JWT 토큰 값을 가지고 사용자를 식별하고 요청을 처리할 수 있다.
- **Interoperable** : JSON 포멧을 사용하기 떄문에 다양한 플랫폼 간에 정보를 교환하기 용이하다.
- **Secure** : 토큰은 서명된 서버에서 생셩되며, 변경되지 않도록 보호되므로 안전한 인증 방식으로 사용된다.

# JWT 구성
JWT는 3개의 Base64 URL-safe 인코딩된 문자열로 구성된다.

JWT는 `Header`.`Payload`.`Signature` 와 같은 형태를 띈다.

헤더에는 총 2개의 정보를 담고있다.
- `typ` : 토큰 타입을 나타내며, JWT인 경우 **JWT**로 지정한다.
- `algorithm` : 토큰을 서명하기 위해 사용된 알고리즘을 나타낸다. 예를 들어, HMAC SHA256또는 RSA 와같은 형태로 작성한다.

페이로드는 클레임이라고 불리는 데이터를 포함한다. 앞서 언급되었던 클레임은 서버와 클라이언트가 공유하는 정보를 담고있다.
클레임은 총 3가지 유형으로 나뉜다.
- 등록되어진 클레임 : **iss(Issue)**, **sub(Subject)**, **aud(Audience)**, **exp(Expired At)**, **nbf(Not Before)**, **iat(Issued At)**, **jti(JWT ID)** 과 같은 사전 정의된 키를 사용한다.
- 공개 클레임 : 충돌을 피하기 위해 서버와 클라이언트 간 사전 약속된 정보를 담는다.
- 비공개 클레임 : 클라이언트와 서버 사이에 사전 협의된 사용자 정의 클레임이다.

서명: 서명은 헤더와 페이로드를 인코딩한 문자열을 비밀키로 사용하여 암호화한 값이다. 서버는 이 서명을 통해 이를 검증하고 토큰이 위변조 되었는지를 호가인한다.

이렇게 총 3가지의 구성을 통해 JWT가 생성되며 아래는 JWT의 예시이다.

`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c`




